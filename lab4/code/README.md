# Лабораторная работа №4
## Ванная комната в общежитии (сетевая версия)

---

## Сборка

```bash
make
```

Или вручную:
```bash
gcc -Wall -Wextra -pthread server.c -o server -lpthread
gcc -Wall -Wextra -pthread client.c -o client -lpthread
```

---

## Запуск

### Терминал 1: Сервер
```bash
./server [кабинок] [макс_входов] [ip_адрес]
```

**Примеры:**
```bash
./server                    # 3 кабинки, макс 5 входов, 0.0.0.0
./server 5 8 0.0.0.0       # 5 кабинок, макс 8 входов
./server 3 5 127.0.0.1     # только localhost
```

### Терминал 2: Клиенты

**Множественные клиенты:**
```bash
./client [ip_сервера] --multi [количество] [процент_мужчин]
```

**Примеры:**
```bash
./client 127.0.0.1 --multi 20 50    # 20 студентов, 50% мужчин
./client 127.0.0.1 --multi 30 80    # 30 студентов, 80% мужчин
```

**Одиночный клиент:**
```bash
./client [ip_сервера] [id] [пол]
./client 127.0.0.1 1 M    # Мужчина
./client 127.0.0.1 2 F     # Женщина
```

---

## Сетевое тестирование

**На сервере:**
```bash
# Узнать IP
hostname -I

# Запустить
./server 3 5 0.0.0.0

# Открыть порт (если нужно)
sudo ufw allow 4567/tcp
```

**На клиенте:**
```bash
./client <IP_СЕРВЕРА> --multi 20 50
```

---

## Остановка

```bash
pkill -f "./server"
```

---

## Диагностика

**Проблема: "Connection refused"**
- Проверить сервер: `pgrep -f "./server"`
- Проверить порт: `netstat -tlnp | grep 4567`

**Проблема: "Address already in use"**
```bash
pkill -f "./server"
```

---

## Параметры

- **Порт:** 4567
- **Время в душе:** 1-4 секунды (случайно)
- **Кабинки:** по умолчанию 3
- **Макс. входов:** по умолчанию 5

